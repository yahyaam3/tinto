import{f as y,n as $,o as a,c as T,w as p,a as e,k as m,l as x,u as w,m as v,h as b,j as V,v as A,b as n,i as _,t as r,F as k,p as B,e as u,N as g}from"./app-78229063.js";import{S as D}from"./SidebarLayout-b4c334aa.js";import{_ as j}from"./Pagination-b6bc7c28.js";import"./_plugin-vue_export-helper-c27b6911.js";const F={class:"py-6"},M={class:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8"},L={class:"flex justify-between items-center mb-6"},P={class:"bg-white rounded-lg shadow mb-6 p-4 flex gap-4"},O={class:"flex-1"},U={class:"w-48"},q={class:"bg-white rounded-lg shadow overflow-hidden"},z={class:"min-w-full divide-y divide-gray-200"},H={class:"bg-white divide-y divide-gray-200"},I={class:"px-6 py-4 whitespace-nowrap font-medium"},G={class:"px-6 py-4 whitespace-nowrap"},J={class:"px-6 py-4 whitespace-nowrap"},K={class:"px-6 py-4"},Q={class:"text-gray-500"},R={class:"px-6 py-4 whitespace-nowrap font-medium"},W={class:"px-6 py-4 whitespace-nowrap"},X={class:"px-6 py-4 whitespace-nowrap text-right text-sm font-medium"},Y=["onClick"],Z=["onClick"],ee=["onClick"],te={key:0},se={key:0,class:"mt-4"},ne={__name:"Index",props:{albaranes:Object,filters:Object},setup(l){const f=l,d=y(f.filters.search||""),c=y(f.filters.estado||"todos");$([d,c],([o,t])=>{g.get("/albaranes",{search:o,estado:t},{preserveState:!0,preserveScroll:!0,replace:!0})});const C=o=>new Date(o).toLocaleDateString("es-ES"),h=o=>Number(o).toFixed(2),N=o=>{confirm(`¿Marcar el albarán #${o.numero} como completado?`)&&g.patch(route("albaranes.marcarCompletado",o.id),{},{preserveScroll:!0,onSuccess:()=>{},onError:t=>{console.error("Error al marcar como completado:",t),alert("Hubo un error al marcar el albarán como completado.")}})},S=o=>{window.open(`/albaranes/${o.id}/ticket`,"_blank")},E=o=>{confirm("¿Estás seguro de que deseas eliminar este albarán?")&&g.delete(`/albaranes/${o.id}`)};return(o,t)=>(a(),T(D,null,{default:p(()=>[e("div",F,[e("div",M,[e("div",L,[t[3]||(t[3]=e("h2",{class:"text-2xl font-semibold"},"Albaranes",-1)),m(w(v),{href:"/albaranes/create",class:"px-4 py-2 bg-indigo-600 text-white rounded-md hover:bg-indigo-700"},{default:p(()=>t[2]||(t[2]=[x(" Nuevo Albarán ")])),_:1})]),e("div",P,[e("div",O,[b(e("input",{type:"text","onUpdate:modelValue":t[0]||(t[0]=s=>d.value=s),placeholder:"Buscar albaranes...",class:"w-full rounded-md border-gray-300"},null,512),[[V,d.value]])]),e("div",U,[b(e("select",{"onUpdate:modelValue":t[1]||(t[1]=s=>c.value=s),class:"w-full rounded-md border-gray-300"},t[4]||(t[4]=[e("option",{value:"todos"},"Todos los estados",-1),e("option",{value:"pendiente"},"Pendiente",-1),e("option",{value:"completado"},"Completado",-1)]),512),[[A,c.value]])])]),e("div",q,[e("table",z,[t[7]||(t[7]=e("thead",{class:"bg-gray-50"},[e("tr",null,[e("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"Nº Albarán"),e("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"Cliente"),e("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"Fecha"),e("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"Productos"),e("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"Total"),e("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"Estado"),e("th",{class:"px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider"},"Acciones")])],-1)),e("tbody",H,[(a(!0),n(k,null,_(l.albaranes.data,s=>(a(),n("tr",{key:s.id},[e("td",I,r(s.numero),1),e("td",G,r(s.cliente.nombre),1),e("td",J,r(C(s.fecha)),1),e("td",K,[(a(!0),n(k,null,_(s.productos,i=>(a(),n("div",{key:i.id,class:"text-sm"},[x(r(i.cantidad)+"x "+r(i.nombre)+" ",1),e("span",Q," ("+r(h(i.pivot.precio_unitario))+"€) ",1)]))),128))]),e("td",R,r(h(s.total))+"€ ",1),e("td",W,[e("span",{class:B(["px-2 inline-flex text-xs leading-5 font-semibold rounded-full",{"bg-yellow-100 text-yellow-800":s.estado==="pendiente","bg-green-100 text-green-800":s.estado==="completado"}])},r(s.estado),3)]),e("td",X,[m(w(v),{href:`/albaranes/${s.id}/edit`,class:"text-indigo-600 hover:text-indigo-900 mr-3"},{default:p(()=>t[5]||(t[5]=[x(" Editar ")])),_:2},1032,["href"]),s.estado==="pendiente"?(a(),n("button",{key:0,onClick:i=>N(s),class:"text-green-600 hover:text-green-900 mr-3"}," Marcar Completado ",8,Y)):u("",!0),e("button",{onClick:i=>S(s),class:"text-gray-600 hover:text-gray-900 mr-3"}," Ticket ",8,Z),e("button",{onClick:i=>E(s),class:"text-red-600 hover:text-red-900"}," Eliminar ",8,ee)])]))),128)),l.albaranes.data.length===0?(a(),n("tr",te,t[6]||(t[6]=[e("td",{colspan:"7",class:"px-6 py-4 text-center text-gray-500"}," No hay registros para mostrar ",-1)]))):u("",!0)])])]),l.albaranes.data.length>0?(a(),n("div",se,[m(j,{links:l.albaranes.links},null,8,["links"])])):u("",!0)])])]),_:1}))}};export{ne as default};

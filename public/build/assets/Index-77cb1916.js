import{P as y,Q as J,m as K,f as L,N as h,r as O,o as _,c as Y,w as S,a as r,k as T,l as C,h as F,j as Z,v as ee,b as P,i as te,t as b,p as re,e as ae,F as ne}from"./app-78229063.js";import{S as oe}from"./SidebarLayout-b4c334aa.js";import{_ as ie}from"./Pagination-b6bc7c28.js";import{_ as se}from"./_plugin-vue_export-helper-c27b6911.js";function de(e){var t=typeof e;return e!=null&&(t=="object"||t=="function")}var W=de,ce=typeof y=="object"&&y&&y.Object===Object&&y,le=ce,fe=le,ue=typeof self=="object"&&self&&self.Object===Object&&self,me=fe||ue||Function("return this")(),A=me,pe=A,ge=function(){return pe.Date.now()},be=ge,xe=/\s/;function ve(e){for(var t=e.length;t--&&xe.test(e.charAt(t)););return t}var ye=ve,he=ye,_e=/^\s+/;function Se(e){return e&&e.slice(0,he(e)+1).replace(_e,"")}var Te=Se,we=A,je=we.Symbol,U=je,D=U,H=Object.prototype,ke=H.hasOwnProperty,Oe=H.toString,x=D?D.toStringTag:void 0;function Ce(e){var t=ke.call(e,x),i=e[x];try{e[x]=void 0;var n=!0}catch{}var f=Oe.call(e);return n&&(t?e[x]=i:delete e[x]),f}var Pe=Ce,Ee=Object.prototype,$e=Ee.toString;function Ie(e){return $e.call(e)}var Ne=Ie,B=U,Le=Pe,Fe=Ne,De="[object Null]",Be="[object Undefined]",M=B?B.toStringTag:void 0;function Me(e){return e==null?e===void 0?Be:De:M&&M in Object(e)?Le(e):Fe(e)}var Ge=Me;function Re(e){return e!=null&&typeof e=="object"}var Ve=Re,We=Ge,Ae=Ve,Ue="[object Symbol]";function He(e){return typeof e=="symbol"||Ae(e)&&We(e)==Ue}var qe=He,ze=Te,G=W,Qe=qe,R=0/0,Xe=/^[-+]0x[0-9a-f]+$/i,Je=/^0b[01]+$/i,Ke=/^0o[0-7]+$/i,Ye=parseInt;function Ze(e){if(typeof e=="number")return e;if(Qe(e))return R;if(G(e)){var t=typeof e.valueOf=="function"?e.valueOf():e;e=G(t)?t+"":t}if(typeof e!="string")return e===0?e:+e;e=ze(e);var i=Je.test(e);return i||Ke.test(e)?Ye(e.slice(2),i?2:8):Xe.test(e)?R:+e}var et=Ze,tt=W,E=be,V=et,rt="Expected a function",at=Math.max,nt=Math.min;function ot(e,t,i){var n,f,m,c,s,l,a=0,d=!1,p=!1,w=!0;if(typeof e!="function")throw new TypeError(rt);t=V(t)||0,tt(i)&&(d=!!i.leading,p="maxWait"in i,m=p?at(V(i.maxWait)||0,t):m,w="trailing"in i?!!i.trailing:w);function j(o){var u=n,g=f;return n=f=void 0,a=o,c=e.apply(g,u),c}function q(o){return a=o,s=setTimeout(v,t),d?j(o):c}function z(o){var u=o-l,g=o-a,N=t-u;return p?nt(N,m-g):N}function $(o){var u=o-l,g=o-a;return l===void 0||u>=t||u<0||p&&g>=m}function v(){var o=E();if($(o))return I(o);s=setTimeout(v,z(o))}function I(o){return s=void 0,w&&n?j(o):(n=f=void 0,c)}function Q(){s!==void 0&&clearTimeout(s),a=0,n=l=f=s=void 0}function X(){return s===void 0?c:I(E())}function k(){var o=E(),u=$(o);if(n=arguments,f=this,l=o,u){if(s===void 0)return q(l);if(p)return clearTimeout(s),s=setTimeout(v,t),j(l)}return s===void 0&&(s=setTimeout(v,t)),c}return k.cancel=Q,k.flush=X,k}var it=ot;const st=J(it),dt={components:{Link:K,SidebarLayout:oe,Pagination:ie},props:{facturas:Object,filters:Object},setup(e){const t=L(e.filters.search||""),i=L(e.filters.estado||"todos"),n=st(()=>{h.get("/facturas",{search:t.value,estado:i.value},{preserveState:!0,replace:!0})},300);return{search:t,estado:i,debouncedSearch:n,filtrar:()=>{h.get("/facturas",{search:t.value,estado:i.value},{preserveState:!0,replace:!0})},marcarComoPagada:d=>{confirm(`¿Marcar la factura #${d.numero} como pagada?`)&&h.patch(route("facturas.marcarPagada",d.id),{},{preserveScroll:!0,onSuccess:()=>{},onError:p=>{console.error("Error al marcar como pagada:",p),alert("Hubo un error al marcar la factura como pagada.")}})},eliminarFactura:d=>{confirm("¿Estás seguro de que deseas eliminar esta factura?")&&h.delete(`/facturas/${d.id}`)},formatDate:d=>new Date(d).toLocaleDateString(),formatPrice:d=>Number(d).toFixed(2),estadoClase:d=>({pendiente:"bg-yellow-100 text-yellow-800",pagada:"bg-green-100 text-green-800"})[d]||"bg-gray-100 text-gray-800"}}},ct={class:"p-6"},lt={class:"flex justify-between items-center mb-6"},ft={class:"bg-white rounded-lg shadow"},ut={class:"p-6 border-b border-gray-200"},mt={class:"flex gap-4"},pt={class:"flex-1"},gt={class:"overflow-x-auto"},bt={class:"min-w-full divide-y divide-gray-200"},xt={class:"bg-white divide-y divide-gray-200"},vt={class:"px-6 py-4 whitespace-nowrap"},yt={class:"px-6 py-4 whitespace-nowrap"},ht={class:"px-6 py-4 whitespace-nowrap"},_t={class:"px-6 py-4 whitespace-nowrap"},St={class:"px-6 py-4 whitespace-nowrap"},Tt={class:"px-6 py-4 whitespace-nowrap text-right text-sm font-medium"},wt=["onClick"],jt=["onClick"],kt={class:"p-6 border-t border-gray-200"};function Ot(e,t,i,n,f,m){const c=O("Link"),s=O("Pagination"),l=O("SidebarLayout");return _(),Y(l,null,{default:S(()=>[r("div",ct,[r("div",lt,[t[5]||(t[5]=r("h2",{class:"text-xl font-semibold text-gray-900"},"Facturas",-1)),T(c,{href:"/facturas/create",class:"px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 transition-colors"},{default:S(()=>t[4]||(t[4]=[C(" Nueva Factura ")])),_:1})]),r("div",ft,[r("div",ut,[r("div",mt,[r("div",pt,[F(r("input",{"onUpdate:modelValue":t[0]||(t[0]=a=>n.search=a),type:"text",placeholder:"Buscar por cliente...",class:"w-full px-4 py-2 border rounded-md",onInput:t[1]||(t[1]=(...a)=>n.debouncedSearch&&n.debouncedSearch(...a))},null,544),[[Z,n.search]])]),F(r("select",{"onUpdate:modelValue":t[2]||(t[2]=a=>n.estado=a),class:"px-4 py-2 border rounded-md",onChange:t[3]||(t[3]=(...a)=>n.filtrar&&n.filtrar(...a))},t[6]||(t[6]=[r("option",{value:"todos"},"Todos los estados",-1),r("option",{value:"pendiente"},"Pendiente",-1),r("option",{value:"pagada"},"Pagada",-1)]),544),[[ee,n.estado]])])]),r("div",gt,[r("table",bt,[t[9]||(t[9]=r("thead",{class:"bg-gray-50"},[r("tr",null,[r("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"}," Número "),r("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"}," Cliente "),r("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"}," Fecha "),r("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"}," Total "),r("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"}," Estado "),r("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"}," Acciones ")])],-1)),r("tbody",xt,[(_(!0),P(ne,null,te(i.facturas.data,a=>(_(),P("tr",{key:a.id},[r("td",vt,b(a.numero),1),r("td",yt,b(a.cliente.nombre),1),r("td",ht,b(n.formatDate(a.fecha)),1),r("td",_t,b(n.formatPrice(a.total))+"€ ",1),r("td",St,[r("span",{class:re([n.estadoClase(a.estado),"px-2 py-1 text-xs rounded-full"])},b(a.estado),3)]),r("td",Tt,[T(c,{href:e.route("facturas.pdf",a.id),class:"text-blue-600 hover:text-blue-900 mr-3",target:"_blank"},{default:S(()=>t[7]||(t[7]=[C(" PDF ")])),_:2},1032,["href"]),T(c,{href:e.route("facturas.edit",a.id),class:"text-indigo-600 hover:text-indigo-900 mr-3"},{default:S(()=>t[8]||(t[8]=[C(" Editar ")])),_:2},1032,["href"]),a.estado==="pendiente"?(_(),P("button",{key:0,onClick:d=>n.marcarComoPagada(a),class:"text-green-600 hover:text-green-900 mr-3"}," Marcar Pagada ",8,wt)):ae("",!0),r("button",{onClick:d=>n.eliminarFactura(a),class:"text-red-600 hover:text-red-900"}," Eliminar ",8,jt)])]))),128))])])]),r("div",kt,[T(s,{links:i.facturas.links},null,8,["links"])])])])]),_:1})}const It=se(dt,[["render",Ot]]);export{It as default};
